<app-modal
  [isOpen]="isOpen"
  (close)="onClose()"
  className="max-w-6xl max-h-[90vh]"
>
  <div class="p-6">
    <!-- Modal Header -->
    <div class="mb-6">
      <h3 class="text-lg font-semibold text-gray-800 dark:text-white/90">
        {{ reportData?.title || 'Report' }}
      </h3>
      <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">
        Generated on: {{ reportData?.generatedAt | date:'medium' }}
      </p>
      <p class="text-sm text-gray-500 dark:text-gray-400">
        Total Items: {{ reportData?.totalItems || 0 }}
      </p>
    </div>

    <!-- Report Content -->
    <div class="space-y-6 max-h-[60vh] overflow-y-auto">
      <!-- Filters Section -->
      <div *ngIf="hasFilters" class="bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4">
        <h4 class="font-semibold text-gray-800 dark:text-white/90 mb-3">
          Applied Filters
        </h4>
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3">
          <div *ngFor="let filter of filterEntries">
            <span class="text-sm text-gray-500 dark:text-gray-400">{{ formatKey(filter[0]) }}:</span>
            <p class="font-medium">{{ filter[1] || 'All' }}</p>
          </div>
        </div>
      </div>

      <!-- Summary Section -->
      <div *ngIf="hasSummary" class="bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4">
        <h4 class="font-semibold text-gray-800 dark:text-white/90 mb-3">
          Summary
        </h4>
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
          <div *ngFor="let summaryItem of summaryEntries" class="text-center">
            <p class="text-2xl font-bold text-brand-600 dark:text-brand-400">
              {{ summaryItem[1] }}
            </p>
            <p class="text-sm text-gray-500 dark:text-gray-400">{{ formatKey(summaryItem[0]) }}</p>
          </div>
        </div>
      </div>

      <!-- Data Table -->
      <div *ngIf="hasItems">
        <h4 class="font-semibold text-gray-800 dark:text-white/90 mb-3">
          Detailed Data ({{ safeItems.length }} items)
        </h4>
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
            <thead class="bg-gray-50 dark:bg-gray-800">
              <tr>
                <th 
                  *ngFor="let column of safeColumns" 
                  class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"
                >
                  {{ column.label }}
                </th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
              <tr *ngFor="let item of safeItems">
                <td 
                  *ngFor="let column of safeColumns" 
                  class="px-4 py-3 text-sm text-gray-900 dark:text-white"
                  [ngClass]="{
                    'text-green-600 dark:text-green-400': column.type === 'level' && item[column.key] >= 80,
                    'text-yellow-600 dark:text-yellow-400': column.type === 'level' && item[column.key] >= 50 && item[column.key] < 80,
                    'text-red-600 dark:text-red-400': column.type === 'level' && item[column.key] < 50
                  }"
                >
                  <ng-container [ngSwitch]="column.type">
                    <!-- Badge Type -->
                    <span *ngSwitchCase="'badge'">
                      <app-badge
                        size="sm"
                        [color]="getStatusBadgeColor(item[column.key])"
                      >
                        {{ formatValue(item[column.key], column) }}
                      </app-badge>
                    </span>

                    <!-- Status Type -->
                    <span *ngSwitchCase="'status'">
                      <app-badge
                        size="sm"
                        [color]="getStatusBadgeColor(item[column.key])"
                      >
                        {{ formatValue(item[column.key], column) }}
                      </app-badge>
                    </span>

                    <!-- Level Type -->
                    <span *ngSwitchCase="'level'">
                      {{ formatValue(item[column.key], column) }}
                    </span>

                    <!-- Default Type -->
                    <span *ngSwitchDefault>
                      {{ formatValue(item[column.key], column) }}
                    </span>
                  </ng-container>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="!hasItems" class="text-center py-8">
        <p class="text-gray-500 dark:text-gray-400">No data available for the report.</p>
      </div>
    </div>

    <!-- Modal Actions -->
    <div class="flex gap-3 mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
      <app-button
        variant="outline"
        (btnClick)="onClose()"
        className="flex-1"
      >
        Close
      </app-button>
      <app-button
        variant="primary"
        (btnClick)="exportAsPDF()"
        className="flex-1"
        [disabled]="!hasItems"
      >
        Export as PDF
      </app-button>
    </div>
  </div>
</app-modal>